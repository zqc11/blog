import{a as Y}from"./display.8569b2e4.js";import{_ as Z,n as k,s as ee,K as I}from"./index.8f675947.js";/* empty css                   */import{d as te,h as a,x as oe,Q as se,N as j,r,z as m,e as o,w as t,H as f,o as d,F as U,G as P,b as D,D as c,C as S,A as ue,bc as x}from"./element-plus.ab042766.js";import"./ui.ef5d2b61.js";import"./plugin-vue_export-helper.98d5223b.js";import"./vform3-plus.5c4eeb71.js";const le={key:0},ae={key:1},ne=c("\u6587\u4EF6\u4E0B\u8F7D"),re=c("\u4EC5\u663E\u793A\u8868\u5355"),de=c("\u4EC5\u663E\u793A\u56FE\u7EB8"),ce=c("\u53CC\u5217\u663E\u793A"),ie=c("\u5BA1\u6279\u9A73\u56DE"),pe=c("\u5BA1\u6279\u901A\u8FC7"),_e={key:1},me={class:"dialog-footer"},fe=c("\u53D6\u6D88"),ve=c("\u786E\u5B9A"),he=te({setup(ye){let g=a(2);const v=k().GET_CURRENT_TASK(),u=a(k().GET_CURRENT_NODE()),R=a(u.value.properties.orderNum),B=a(R.value),h=a([]),O=v.blueprints;let p=a(O[0]);const y=a(""),b=a("primary"),C=a(""),N=ee.getItem("info").userInfo.id,E=a(!1);let A=oe(()=>{console.log(u.value);const s=u.value.properties.hasPassed!==null?u.value.properties.hasPassed.indexOf(N+"")!==-1:!1,e=u.value.properties.hasRejected!==null?u.value.properties.hasRejected.indexOf(N+"")!==-1:!1;return"\u8FDB\u884C\u4E2D|\u88AB\u9A73\u56DE".indexOf(u.value.properties.status)===-1||s||e});function V(){g.value=1,y.value="primary",b.value="",C.value=""}function L(){g.value=2,y.value="",b.value="primary",C.value=""}function G(){g.value=3,y.value="",b.value="",C.value="primary"}const H=s=>{p.value=s,k().SET_CURRENT_BLUEPRINT(p.value)},J=()=>{E.value=!0},K=()=>{const s={taskId:v.id,type:"\u5BA1\u6279\u901A\u8FC7",checker:N,launchOrderNum:u.value.properties.orderNum,endOrderNum:u.value.properties.orderNum+1};I(JSON.stringify(s)).then(e=>{e.success&&(u.value.properties.status="\u5DF2\u5B8C\u6210",x.success("\u63D0\u4EA4\u6210\u529F"))}).catch(e=>{x.error(e.message)})},M=()=>{const s={taskId:v.id,type:"\u5BA1\u6279\u9A73\u56DE",checker:N,launchOrderNum:u.value.properties.orderNum,endOrderNum:B.value};I(JSON.stringify(s)).then(e=>{e.success&&(u.value.properties.status="\u672A\u5F00\u59CB",E.value=!1,x.success("\u63D0\u4EA4\u6210\u529F"))}).catch(e=>{x.error(e.message)})},$=s=>{B.value=s.properties.orderNum},z=()=>{const s=p.value.filename,e=document.createElement("a");e.download=s,e.style.display="none",e.href="http://localhost:8080/getPdfFile/"+s,document.body.appendChild(e),e.click(),URL.revokeObjectURL(e.href),document.body.removeChild(e)};return se(()=>{const s=v.flowChart.edges,e=v.flowChart.nodes,w=s.filter(l=>l.sourceNodeId===u.value.id).map(l=>l.targetNodeId);h.value=e.filter(l=>w.indexOf(l.id)!==-1&&l.properties.orderNum<R.value),h.value.sort((l,F)=>l.properties.orderNum-F.properties.orderNum)}),k().SET_CURRENT_BLUEPRINT(p.value),j("show",g),j("blueprint",p),j("disabled",A),(s,e)=>{const w=r("el-dropdown-item"),l=r("el-dropdown-menu"),F=r("el-dropdown"),i=r("el-button"),_=r("el-col"),Q=r("el-row"),q=r("el-step"),W=r("el-steps"),X=r("el-dialog");return d(),m("div",null,[o(Q,{gutter:6,id:"toolbar",justify:"start"},{default:t(()=>[o(F,{trigger:"click","split-button":"",onCommand:H},{dropdown:t(()=>[o(l,null,{default:t(()=>[(d(!0),m(U,null,P(f(O),(n,T)=>(d(),D(w,{key:T,command:n},{default:t(()=>[c(S(n.filename),1)]),_:2},1032,["command"]))),128))]),_:1})]),default:t(()=>[f(p)==null?(d(),m("span",le,"\u663E\u793A\u56FE\u7EB8")):(d(),m("span",ae,S(f(p).filename),1))]),_:1}),o(_,{xs:6,sm:4,md:3,lg:2,xl:2},{default:t(()=>[o(i,{class:"top-menu-button",onClick:z,type:y.value},{default:t(()=>[ne]),_:1},8,["type"])]),_:1}),o(_,{xs:6,sm:4,md:3,lg:2,xl:2},{default:t(()=>[o(i,{class:"top-menu-button",onClick:V,type:y.value},{default:t(()=>[re]),_:1},8,["type"])]),_:1}),o(_,{xs:6,sm:4,md:3,lg:2,xl:2},{default:t(()=>[o(i,{class:"top-menu-button",onClick:L,type:b.value},{default:t(()=>[de]),_:1},8,["type"])]),_:1}),o(_,{xs:6,sm:4,md:3,lg:2,xl:2,class:"hidden-sm-and-down"},{default:t(()=>[o(i,{class:"top-menu-button",onClick:G,type:C.value},{default:t(()=>[ce]),_:1},8,["type"])]),_:1}),o(_,{xs:6,sm:4,md:3,lg:2,xl:2},{default:t(()=>[o(i,{type:"danger",class:"top-menu-button justify-end",disabled:f(A),onClick:J},{default:t(()=>[ie]),_:1},8,["disabled"])]),_:1}),o(_,{xs:6,sm:4,md:3,lg:2,xl:2},{default:t(()=>[o(i,{type:"success",class:"top-menu-button justify-end",disabled:f(A),onClick:K},{default:t(()=>[pe]),_:1},8,["disabled"])]),_:1})]),_:1}),o(X,{modelValue:E.value,"onUpdate:modelValue":e[1]||(e[1]=n=>E.value=n),title:"\u8BF7\u9009\u62E9\u9A73\u56DE\u5230\u7684\u8282\u70B9",width:"30%"},{footer:t(()=>[ue("span",me,[o(i,{onClick:e[0]||(e[0]=n=>E.value=!1)},{default:t(()=>[fe]),_:1}),o(i,{type:"primary",onClick:M,disabled:h.value.length===0},{default:t(()=>[ve]),_:1},8,["disabled"])])]),default:t(()=>[h.value.length>0?(d(),D(W,{key:0,active:B.value-1,"align-center":""},{default:t(()=>[(d(!0),m(U,null,P(h.value,n=>(d(),D(q,{title:n.text.value,key:n.id,onClick:T=>$(n)},null,8,["title","onClick"]))),128))]),_:1},8,["active"])):(d(),m("span",_e,"\u6682\u65E0\u53EF\u9009\u62E9\u7684\u9A73\u56DE\u8282\u70B9"))]),_:1},8,["modelValue"]),o(f(Y))])}}});var Be=Z(he,[["__scopeId","data-v-10ed16e4"]]);export{Be as default};
