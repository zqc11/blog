(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e3ce3d4"],{"0253":function(e,t,i){"use strict";i.r(t);var s={props:{vHeight:{type:Number,default:450},vTemplateID:{type:String,default:"defaultID"},vCurrentStepID:{type:String,default:"defaultID"}},data(){return{mCurrentStepID:[],mCurrentTemplateID:"",multipleSelection:[],mSelect:[],curPath:"",curNode:"",currentGroupID:"",vName:"",vRemark:"",vTypeID:"",vID:"",vNo:"",vIsUDTable:!1,vIsInborn:!1,vIsActive:!1,vIsVersion:!1,queryInfo:{query:"",pagenum:1,pagesize:10},mtemp:[""],tableHeight:window.innerHeight-275,slbHeight:window.innerHeight-275,mainHeight:window.innerHeight-400,DataName:"Item Detail",addDataForm:{},editDataForm:{},editFieldForm:{},datalist:[],templist:[],FieldDropDownArgList:[],vStrOption:"",groupList:[],userList:[],allUserList:[],catFieldList:[],editDialogVisible:!1,addDialogVisible:!1,allotDialogVisible:!1,cascaderProps:{value:"t_ID",label:"label",children:"Children",checkStrictly:!0,isLeaf:"leaf"},selectedKeys:[],cat_pid:0,cat_level:0,config:{id:"t_ID",pid:"ParentID",children:"children"},idArray:[],pageFlag:!0}},watch:{vTemplateID(e,t){this.mCurrentTemplateID=e},vCurrentStepID(e,t){this.mCurrentStepID=e}},created(){this.$root.leveOnePathName="权限管理",this.$root.leveTwoPathName="组织与用户",this.mCurrentTemplateID=this.vTemplateID,this.mCurrentStepID=this.vCurrentStepID,this.tableHeight=this.vHeight,this.slbHeight=this.vHeight,this.getAllUser(),null!==window.localStorage.getItem("currentGroupID")&&(this.queryInfo.catID=window.localStorage.getItem("currentGroupID"),this.idArray=[this.queryInfo.catID]),this.$nextTick((function(){}))},mounted(){this.tempselect=this.select2,this.refreshNodeBy(this.currentGroupID)},methods:{async addExecutor(){if(this.mSelect=[],0===this.multipleSelection.length)return this.$message.error("请先选择用户！");for(let e=0;e<this.multipleSelection.length;e++)this.mSelect[e]=this.multipleSelection[e].t_ID,this.mSelect[e]=this.multipleSelection[e].t_Name;this.mSelect[0]=this.multipleSelection[0].t_ID,this.mSelect[1]=this.multipleSelection[0].t_Name,this.$emit("getCurrentUserID",this.mSelect)},toggleSelection(e){e?e.forEach(e=>{this.$refs.allUserTableRef.toggleRowSelection(e)}):null!=this.$refs.allUserTableRef&&this.$refs.allUserTableRef.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},toggleSelectiongroupUser(e){e?e.forEach(e=>{this.$refs.groupUserTableRef.toggleRowSelection(e)}):this.$refs.groupUserTableRef.clearSelection()},handleRowClickgroupUser(e){this.multipleSelection[0]=e},handleRowClick(e){this.$refs.allUserTableRef.toggleRowSelection(e),e=this.$refs.allUserTableRef.selection,this.handleSelectionChange(e)},handleSizeChange(e){this.queryInfo.pagesize=e,this.getAllUser()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getAllUser()},selectChange(e){const t=[];for(var i of(this.select2=[],this.allrole))e===i.pro&&(this.editFieldForm.t_ControlType=i.value,t.push({label:i.label,value:i.value})),this.select2=t;this.$forceUpdate()},selectValue(e){this.$forceUpdate()},focus(e){},keyup_({e:e,i:t}){const i=this;i.$refs["input"+t]&&i.$nextTick(()=>{e.target.blur();var s="input"+(t+1);void 0!==i.$refs[s]?i.$refs[s][0].focus():i.$refs.addSubmit&&i.$refs.addSubmit.$el.focus()})},keyup_edit({e:e,i:t}){const i=this;i.$refs["m_input"+t]&&i.$nextTick(()=>{e.target.blur();var s="m_input"+(t+1);void 0!==i.$refs[s]?i.$refs[s][0].focus():i.$refs.editSubmit&&i.$refs.editSubmit.$el.focus()})},handleRadioChange:function(e,t,i){},handleChange:function(e,t,i){e?this.checkedData[i].push(t):this.delete(t,i)},delete(e,t){var i=this.checkedData[t].findIndex(t=>{if(t===e)return!0});this.checkedData[t].splice(i,1)},SetFirstAddFocus(){this.$nextTick(e=>{this.$refs.input0[0].focus()})},SetFirstEditFocus(){this.$nextTick(e=>{this.$refs.m_input0[0].focus()})},async linkUserGroup(){this.mSelect=[];for(let t=0;t<this.multipleSelection.length;t++)this.mSelect[t]=this.multipleSelection[t].t_ID;return 0===this.mSelect.length?this.$message.error("请先选择用户！"):(e=(await this.$http.post("linkUserGroup",{hGroupID:this.currentGroupID,hUserIDList:JSON.stringify(this.mSelect)}))["data"],200!==e.status?this.$message.error("分配用户失败！"):(this.refreshNodeBy(this.currentGroupID),this.multipleSelection=[],void(this.allotDialogVisible=!1)));var e},async getAllUser(){var e=(await this.$http.post("getAllUser",{hName:this.queryInfo.query}))["data"];if(200!==e.status)return this.$message.error("获取用户列表失败！");this.allUserList=JSON.parse(e.data)},mapStatus(e){return 1===e},mapBool(e){return!0===e?1:0},async getGroupList(e,t){if(e=(await this.$http.post("getGroupList",{hGroupID:e})).data,200!==e.status)return this.$message.error("获取子组织节点失败！");var i=JSON.parse(e.data);return this.groupList=JSON.parse(e.data),this.userList=JSON.parse(e.mStream),i.forEach(e=>{e.id=e.t_ID,e.label=e.t_Name,e.num=e.CHILD_GROUPS,0<e.CHILD_GROUPS?e.leaf=!1:e.leaf=!0}),t(i)},handleNodeClick(e,t,i){this.currentGroupID=e.id,this.refreshNodeBy(t.data.id),this.idArray=[e.t_ID]},refreshNodeBy(e){const t=this.$refs.treeList.getNode(e);t.loaded=!1,t.expand()},loadNode(e,t){if(0===e.level)return t([{id:this.currentGroupID="DEFAULTROOT",label:"组织根节点",t_IsActive:1}]);1<=e.level&&(this.currentGroupID=e.data.id,this.getGroupList(e.data.id,t))}}};i("b956"),i=i("2877"),i=Object(i.a)(s,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{ref:"mainZone"},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:24}},[i("el-button-group",{staticStyle:{float:"right"}},[i("el-button",{attrs:{type:"plain"},on:{click:e.addExecutor}},[e._v("增加执行人")])],1)],1)],1),i("el-row",{attrs:{gutter:0}},[i("el-col",{attrs:{span:12}},[i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("el-scrollbar",{style:{height:e.slbHeight+"px"}},[i("el-tree",{ref:"treeList",attrs:{"default-expanded-keys":e.idArray,"highlight-current":"",id:"el-tree",props:e.cascaderProps,load:e.loadNode,"node-key":"id",lazy:""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node;t=t.data;return i("span",{staticClass:"slot-t-node"},[i("span",{attrs:{name:s.label}},[0<t.t_IsActive?i("i",{staticClass:"iconfont"},[e._v(" ")]):i("i",{staticClass:"iconfont"},[e._v(" ")]),e._v(e._s(s.label)+" ")])])}}])})],1)],1)],1),i("el-col",{attrs:{span:12}},[i("el-row",[i("el-card",{attrs:{"body-style":{padding:"0px"}}},[i("el-table",{ref:"groupUserTableRef",attrs:{data:e.userList,height:e.tableHeight,"highlight-current-row":"","row-style":{height:"30px"},"cell-style":{padding:"0px"}},on:{"row-click":e.handleRowClickgroupUser}},[i("el-table-column",{attrs:{type:"index",width:"55"}}),e._e(),e._e(),e._e(),e._e(),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_Name",label:"姓名"}}),e._e(),e._e(),e._e(),e._e(),e._e(),e._e(),i("el-table-column",{attrs:{label:"在岗",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-switch",{attrs:{"active-color":"#00ffff","active-value":1,"inactive-value":0,disabled:""},model:{value:t.row.t_IsOnJob,callback:function(i){e.$set(t.row,"t_IsOnJob",i)},expression:"scope.row.t_IsOnJob"}})]}}])}),e._e(),e._e()],1)],1)],1)],1)],1)],1)}),[],!1,null,"aa714ecc",null);t.default=i.exports},7529:function(e,t,i){},b956:function(e,t,i){"use strict";i("7529")}}]);