(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5f8aef7b"],{"641a":function(e,t,l){"use strict";l("d9e5")},d9e5:function(e,t,l){},e90a:function(e,t,l){"use strict";l.r(t);var a={data(){return{MapVisible:!0,ImportPartVisible:!0,fileList:[],mUrl:"",pDataList:[],tmpName:"",ItemPartBFieldList:[{t_Name:"空"}],excelFieldList:[{ColumnName:"空"}],mainHeight:2e3}},created(){this.mUrl=this.$root.gBaseURL+"/upLoadandReadExcel"},methods:{handleSuccess(e){return 209===e.status?(this.$notify({title:"错误提示",message:"excel 文件中必须包含 代号、名称、所属部件的代号 三个标题栏！！！",duration:0}),this.$message.error("excel 文件中必须包含 代号、名称、所属部件的代号 三个标题栏！！！！")):200!==e.status?this.$message.error("上传文件失败！"):(this.ItemPartBFieldList=JSON.parse(e.tableBfield),this.excelFieldList=JSON.parse(e.tableAfield),this.tmpName=e.data,void(this.MapVisible=!0))},tableRowClassName({row:e}){if(100<=e.t_No)return"warning-row"},beforeUpload(e){const t=e.name;return e=t.split("."),"xls"!==e[1]&&"xlsx"!==e[1]?(this.$message.error("上传文件只能是 excel/xls 格式!"),!1):e},handleChange(e,t){this.fileList=t.slice(-3)},handleRemove(e,t){},handlePreview(e){},submitUpload(){this.$refs.upload.submit(),this.ImportPartVisible=!1},async ImportExcel(){if("confirm"!==await this.$confirm("此操作将Importexcel data to database, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(e=>e))return this.$message.info("已取消import");var e=(await this.$http.post("ImportToDataBase",{hExcelFieldList:JSON.stringify(this.excelFieldList),hPartBFieldList:JSON.stringify(this.ItemPartBFieldList),hExcelName:this.tmpName}))["data"];return 200!==e.status?this.$message.error("import excel data 失败！"):this.$message.info("import excel data 成功！")},moveUp(e,t){var l,a=this;0<e?(l=a.excelFieldList[e-1],a.excelFieldList.splice(e-1,1),a.excelFieldList.splice(e,0,l)):alert("已经是第一条，不可上移")},moveDown(e,t){var l,a=this;e+1===a.excelFieldList.length?alert("已经是最后一条，不可下移"):(l=a.excelFieldList[e+1],a.excelFieldList.splice(e+1,1),a.excelFieldList.splice(e,0,l))}}};l("641a"),l=l("2877"),l=Object(l.a)(a,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{ref:"mainZone",attrs:{height:e.mainHeight}},[l("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[l("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),l("el-breadcrumb-item",[e._v("BOM 管理")]),l("el-breadcrumb-item",[e._v("Import Parts")])],1),l("el-dialog",{attrs:{title:"指定导入的Excel文件",visible:e.ImportPartVisible,width:"50%"},on:{"update:visible":function(t){e.ImportPartVisible=t},close:function(t){e.ImportPartVisible=!1}}},[l("div",{attrs:{id:"result"}}),l("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{drag:"",action:e.mUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"on-change":e.handleChange,"on-success":e.handleSuccess,"before-upload":e.beforeUpload,accept:".xlsx, .xls","file-list":e.fileList,"auto-upload":!1}},[l("i",{staticClass:"el-icon-upload"}),l("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),l("em",[e._v("点击上传")])]),l("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传Excel文件，且不超过1500kb")])]),l("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{on:{click:function(t){e.ImportPartVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.submitUpload}},[e._v("确定")])],1)],1),e.MapVisible?l("el-row",{attrs:{gutter:10}},[l("el-button",{on:{click:function(t){e.ImportPartVisible=!1}}},[e._v("取 消")]),l("el-button",{attrs:{type:"primary"},on:{click:e.ImportExcel}},[e._v("Import")])],1):e._e(),e.MapVisible?l("el-row",{attrs:{gutter:10}},[l("el-col",{staticClass:"col-1",attrs:{span:6}},[l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.ItemPartBFieldList,border:"",fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName}},[l("el-table-column",{attrs:{align:"center",label:"序号",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.$index+1))])]}}],null,!1,4178052834)}),l("el-table-column",{attrs:{align:"center",label:"OnlyBom 数据库字段名",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.t_Name))])]}}],null,!1,712804490)})],1)],1),l("el-col",{staticClass:"col-2",attrs:{span:12}},[l("el-table",{staticStyle:{width:"100%"},attrs:{data:e.excelFieldList,border:"",fit:"","highlight-current-row":"","row-class-name":e.tableRowClassName}},[l("el-table-column",{attrs:{align:"center",label:"序号",width:"65"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.$index+1))])]}}],null,!1,4178052834)}),l("el-table-column",{attrs:{align:"center",label:"Excel Column Name",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("span",[e._v(e._s(t.row.t_Name))])]}}],null,!1,712804490)}),l("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{size:"mini",disabled:0===t.$index},on:{click:function(l){return e.moveUp(t.$index,t.row)}}},[l("i",{staticClass:"el-icon-arrow-up"})]),l("el-button",{attrs:{size:"mini",disabled:t.$index===e.excelFieldList.length-1},on:{click:function(l){return e.moveDown(t.$index,t.row)}}},[l("i",{staticClass:"el-icon-arrow-down"})])]}}],null,!1,3224142972)})],1)],1)],1):e._e()],1)}),[],!1,null,"0e9a8eee",null);t.default=l.exports}}]);