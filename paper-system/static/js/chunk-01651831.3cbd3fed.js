(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-01651831"],{"28c1":function(e,t,l){},"599e":function(e,t,l){"use strict";l("28c1")},"7fd1":function(e,t,l){"use strict";l.r(t);var a={data(){return{multipleSelection:[],mSelect:[],curPath:"",curNode:"",currentGroupID:"",vName:"",vRemark:"",vTypeID:"",vID:"",vNo:"",vIsUDTable:!1,vIsInborn:!1,vIsActive:!1,vIsVersion:!1,queryInfo:{query:"",pagenum:1,pagesize:10},mtemp:[""],tableHeight:window.innerHeight-275,mainHeight:window.innerHeight-400,DataName:"Item Detail",addDataForm:{},editDataForm:{},editFieldForm:{},datalist:[],templist:[],FieldDropDownArgList:[],vStrOption:"",groupList:[],userList:[],allUserList:[],catFieldList:[],editDialogVisible:!1,addDialogVisible:!1,allotDialogVisible:!1,cascaderProps:{value:"t_ID",label:"label",children:"Children",checkStrictly:!0,isLeaf:"leaf"},selectedKeys:[],cat_pid:0,cat_level:0,config:{id:"t_ID",pid:"ParentID",children:"children"},idArray:[],pageFlag:!0}},created(){this.$root.leveOnePathName="权限管理",this.$root.leveTwoPathName="组织与用户",this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-240,this.slbHeight=JSON.parse(window.localStorage.getItem("gHeight"))-195,this.mainHeight=JSON.parse(window.localStorage.getItem("gHeight"))-185,this.mainWidth=this.$root.gScreenWidth-210,this.getAllUser(),null!==window.localStorage.getItem("currentGroupID")&&(this.queryInfo.catID=window.localStorage.getItem("currentGroupID"),this.idArray=[this.queryInfo.catID]),this.$nextTick((function(){}))},mounted(){this.tempselect=this.select2,this.refreshNodeBy(this.currentGroupID)},methods:{toggleSelection(e){e?e.forEach(e=>{this.$refs.allUserTableRef.toggleRowSelection(e)}):null!=this.$refs.allUserTableRef&&this.$refs.allUserTableRef.clearSelection()},handleSelectionChange(e){this.multipleSelection=e},toggleSelectiongroupUser(e){e?e.forEach(e=>{this.$refs.groupUserTableRef.toggleRowSelection(e)}):this.$refs.groupUserTableRef.clearSelection()},handleRowClickgroupUser(e){this.$refs.groupUserTableRef.toggleRowSelection(e),e=this.$refs.groupUserTableRef.selection,this.handleSelectionChange(e)},handleRowClick(e){this.$refs.allUserTableRef.toggleRowSelection(e),e=this.$refs.allUserTableRef.selection,this.handleSelectionChange(e)},handleSizeChange(e){this.queryInfo.pagesize=e,this.getAllUser()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getAllUser()},selectChange(e){const t=[];for(var l of(this.select2=[],this.allrole))e===l.pro&&(this.editFieldForm.t_ControlType=l.value,t.push({label:l.label,value:l.value})),this.select2=t;this.$forceUpdate()},selectValue(e){this.$forceUpdate()},dataTypeFormatter(e,t){return e=e.t_DataType,1===e?"字符":2===e?"整数":3===e?"数值":4===e?"日期":5===e?"文本":6===e?"图片":8===e?"文件":"其他"},controlTypeFormatter(e,t){return e=e.t_ControlType,0===e?"No Define":1===e?"el-input":2===e?"el-input textarea":3===e?"el-select":4===e?"el-checkbox-group":11===e?"el-radio":30===e?"el-radio-group":12===e?"el-date-picker":14===e?"el-14":15===e?"el-15":108===e?"el-108":"其他"},focus(e){},keyup_({e:e,i:t}){const l=this;l.$refs["input"+t]&&l.$nextTick(()=>{e.target.blur();var a="input"+(t+1);void 0!==l.$refs[a]?l.$refs[a][0].focus():l.$refs.addSubmit&&l.$refs.addSubmit.$el.focus()})},keyup_edit({e:e,i:t}){const l=this;l.$refs["m_input"+t]&&l.$nextTick(()=>{e.target.blur();var a="m_input"+(t+1);void 0!==l.$refs[a]?l.$refs[a][0].focus():l.$refs.editSubmit&&l.$refs.editSubmit.$el.focus()})},handleRadioChange:function(e,t,l){},handleChange:function(e,t,l){e?this.checkedData[l].push(t):this.delete(t,l)},delete(e,t){var l=this.checkedData[t].findIndex(t=>{if(t===e)return!0});this.checkedData[t].splice(l,1)},SetFirstAddFocus(){this.$nextTick(e=>{this.$refs.input0[0].focus()})},SetFirstEditFocus(){this.$nextTick(e=>{this.$refs.m_input0[0].focus()})},async linkUserGroup(){this.mSelect=[];for(let t=0;t<this.multipleSelection.length;t++)this.mSelect[t]=this.multipleSelection[t].t_ID;return 0===this.mSelect.length?this.$message.error("请先选择用户！"):(e=(await this.$http.post("linkUserGroup",{hGroupID:this.currentGroupID,hUserIDList:JSON.stringify(this.mSelect)}))["data"],200!==e.status?this.$message.error("分配用户失败！"):(this.refreshNodeBy(this.currentGroupID),this.multipleSelection=[],void(this.allotDialogVisible=!1)));var e},async getAllUser(){var e=(await this.$http.post("getAllUser",{hName:this.queryInfo.query}))["data"];if(200!==e.status)return this.$message.error("获取用户列表失败！");this.allUserList=JSON.parse(e.data),this.$message.success("获取用户列表成功！")},async openaddGroupDialog(){this.vName="",this.vRemark="",this.vIsActive=!1,this.vIsDynamic=!1,this.queryInfo.query="",this.allotDialogVisible=!0,this.toggleSelection()},async removeDataById(){this.mSelect=[];for(let t=0;t<this.multipleSelection.length;t++)this.mSelect[t]=this.multipleSelection[t].t_ID;if(0===this.mSelect.length)return this.$message.error("请先选择用户！");var e=(await this.$http.post("DropGroupUser",{hGroupID:this.currentGroupID,hUserIDList:JSON.stringify(this.mSelect)}))["data"];200!==e.status?this.$message.error("移除用户失败！-- 030"+e.Msg):(this.$message.success("移除用户成功！"),this.refreshNodeBy(this.currentGroupID))},mapStatus(e){return 1===e},mapBool(e){return!0===e?1:0},async getGroupList(e,t){if(e=(await this.$http.post("getGroupList",{hGroupID:e})).data,200!==e.status)return this.$message.error("获取子组织节点失败！");var l=JSON.parse(e.data);return this.groupList=JSON.parse(e.data),this.userList=JSON.parse(e.mStream),l.forEach(e=>{e.id=e.t_ID,e.label=e.t_Name,e.num=e.CHILD_GROUPS,0<e.CHILD_GROUPS?e.leaf=!1:e.leaf=!0}),t(l)},handleNodeClick(e,t,l){this.currentGroupID=e.id,this.refreshNodeBy(t.data.id),this.idArray=[e.t_ID]},refreshNodeBy(e){const t=this.$refs.treeList.getNode(e);t.loaded=!1,t.expand()},loadNode(e,t){if(0===e.level)return t([{id:this.currentGroupID="DEFAULTROOT",label:"组织根节点",t_IsActive:1}]);1<=e.level&&(this.currentGroupID=e.data.id,this.getGroupList(e.data.id,t))}}};l("599e"),l=l("2877"),l=Object(l.a)(a,(function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{ref:"mainZone",staticClass:"datalist-container"},[l("el-row",{attrs:{gutter:5}},[l("el-col",{attrs:{span:4}},[l("el-card",{attrs:{"body-style":{padding:"5px"}}},[l("el-scrollbar",{style:{height:e.slbHeight+"px"}},[l("el-tree",{ref:"treeList",attrs:{"default-expanded-keys":e.idArray,"highlight-current":"",id:"el-tree",props:e.cascaderProps,load:e.loadNode,"node-key":"id",lazy:""},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node;t=t.data;return l("span",{staticClass:"slot-t-node"},[l("span",{attrs:{name:a.label}},[0<t.t_IsActive?l("i",{staticClass:"iconfont"},[e._v(" ")]):l("i",{staticClass:"iconfont"},[e._v(" ")]),e._v(e._s(a.label)+" ")])])}}])})],1)],1)],1),l("el-col",{attrs:{span:20}},[l("el-row",[l("el-card",{attrs:{"body-style":{padding:"5px"}}},[l("el-row",{attrs:{gutter:10}},[l("el-col",{attrs:{span:8}},[l("el-button",{attrs:{type:"primary"},on:{click:e.openaddGroupDialog}},[e._v("分配用户")]),l("el-button",{attrs:{type:"primary"},on:{click:e.removeDataById}},[e._v("移去用户")])],1)],1),l("el-table",{ref:"groupUserTableRef",attrs:{data:e.userList,height:e.tableHeight,border:"",stripe:"","highlight-current-row":"","row-style":{height:"30px"},"cell-style":{padding:"0px"}},on:{"row-click":e.handleRowClickgroupUser,"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),e._e(),e._e(),e._e(),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_LoginName",label:"用户名"}}),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_Name",label:"姓名"}}),l("el-table-column",{attrs:{label:"性别",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(0===t.row.t_Sex?"男":"女"))]}}])}),l("el-table-column",{attrs:{prop:"t_Birthday",label:"出生年月"}}),l("el-table-column",{attrs:{prop:"t_ContactInfo",label:"联系方式"}}),l("el-table-column",{attrs:{prop:"t_Position",label:"职位"}}),l("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_CreateTime",label:"创建时间"}}),e._e(),l("el-table-column",{attrs:{label:"在岗",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:t.row.t_IsOnJob,callback:function(l){e.$set(t.row,"t_IsOnJob",l)},expression:"scope.row.t_IsOnJob"}})]}}])}),l("el-table-column",{attrs:{label:"启用",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:t.row.t_IsActive,callback:function(l){e.$set(t.row,"t_IsActive",l)},expression:"scope.row.t_IsActive"}})]}}])}),e._e()],1)],1)],1)],1)],1),l("el-dialog",{attrs:{title:"分配用户到部门",visible:e.allotDialogVisible,width:"70%"},on:{"update:visible":function(t){e.allotDialogVisible=t}}},[l("el-card",[l("el-row",{attrs:{gutter:20}},[l("el-col",{attrs:{span:8}},[l("el-input",{attrs:{placeholder:"请输入用户名",clearable:""},on:{clear:e.getAllUser},model:{value:e.queryInfo.query,callback:function(t){e.$set(e.queryInfo,"query",t)},expression:"queryInfo.query"}},[l("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getAllUser},slot:"append"})],1)],1),l("el-col",{attrs:{span:16}},[l("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.linkUserGroup()}}},[e._v("确认分配")]),l("el-button",{staticStyle:{float:"right"},on:{click:function(t){return e.toggleSelection([e.allUserList[1],e.allUserList[2]])}}},[e._v("切换选中状态")]),l("el-button",{staticStyle:{float:"right"},on:{click:function(t){return e.toggleSelection()}}},[e._v("取消选择")])],1)],1),l("el-table",{ref:"allUserTableRef",attrs:{data:e.allUserList,height:e.tableHeight-250,border:"",stripe:"","highlight-current-row":"","row-style":{height:"30px"},"cell-style":{padding:"0px"}},on:{"row-click":e.handleRowClick,"selection-change":e.handleSelectionChange}},[l("el-table-column",{attrs:{type:"selection",width:"55"}}),l("el-table-column",{attrs:{type:"index"}}),l("el-table-column",{attrs:{label:"用户名",prop:"t_LoginName"}}),l("el-table-column",{attrs:{label:"真实姓名",prop:"t_Name"}}),e._e(),e._e(),l("el-table-column",{attrs:{label:"联系方式",prop:"t_ContactInfo"}}),l("el-table-column",{attrs:{label:"出生年月",prop:"t_Birthday"}}),e._e(),l("el-table-column",{attrs:{label:"性别",width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:t.row.t_Sex,callback:function(l){e.$set(t.row,"t_Sex",l)},expression:"scope.row.t_Sex"}})]}}])}),e._e(),e._e()],1)],1)],1)],1)}),[],!1,null,"fefb14c4",null);t.default=l.exports}}]);