(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a916dd3c"],{"1eb5":function(t,e,i){"use strict";i("6294")},6294:function(t,e,i){},d825:function(t,e,i){"use strict";i.r(e);var a={data(){return{curPath:"",curNode:"",currentGroupID:"",queryInfo:{query:"",pageNum:"1",pageSize:"30",catID:"IDATA"},slbHeight:this.$root.gScreenHeight-90,mainHeight:this.$root.gScreenHeight-400,tableHeight:this.$root.gScreenHeight-140,addForm:{vName:"",vRemark:"",vTypeID:"",vID:"",vNo:"",vIsActive:!1,vIsDynamic:!1},editForm:{vName:"",vRemark:"",vTypeID:"",vID:"",vNo:"",vIsActive:!1,vIsDynamic:!1},mtemp:[""],DataName:"Item Detail",addDataForm:{},editDataForm:{},editFieldForm:{},datalist:[],templist:[],FieldDropDownArgList:[],vStrOption:"",groupList:[],userList:[],catFieldList:[],editDialogVisible:!1,addDialogVisible:!1,cascaderProps:{value:"t_ID",label:"label",children:"Children",checkStrictly:!0,isLeaf:"leaf"},selectedKeys:[],cat_pid:0,cat_level:0,config:{id:"t_ID",pid:"ParentID",children:"children"},idArray:[],pageFlag:!0}},created(){this.$root.leveOnePathName="权限管理",this.$root.leveTwoPathName="组织列表",this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-240,this.slbHeight=JSON.parse(window.localStorage.getItem("gHeight"))-195,this.mainHeight=JSON.parse(window.localStorage.getItem("gHeight"))-185,this.mainWidth=this.$root.gScreenWidth-210,null!==window.localStorage.getItem("currentGroupID")&&(this.queryInfo.catID=window.localStorage.getItem("currentGroupID"),this.idArray=[this.queryInfo.catID]),this.$nextTick((function(){}))},destroyed(){},mounted(){this.tempselect=this.select2,this.refreshNodeBy(this.currentGroupID)},computed:{scrollerHeight:function(){return window.innerHeight-125+"px"}},methods:{getHeight(){this.tableHeight=window.innerHeight-173},selectChange(t){const e=[];for(var i of(this.select2=[],this.allrole))t===i.pro&&(this.editFieldForm.t_ControlType=i.value,e.push({label:i.label,value:i.value})),this.select2=e;this.$forceUpdate()},selectValue(t){this.$forceUpdate()},dataTypeFormatter(t,e){return t=t.t_DataType,1===t?"字符":2===t?"整数":3===t?"数值":4===t?"日期":5===t?"文本":6===t?"图片":8===t?"文件":"其他"},controlTypeFormatter(t,e){return t=t.t_ControlType,0===t?"No Define":1===t?"el-input":2===t?"el-input textarea":3===t?"el-select":4===t?"el-checkbox-group":11===t?"el-radio":30===t?"el-radio-group":12===t?"el-date-picker":14===t?"el-14":15===t?"el-15":108===t?"el-108":"其他"},focus(t){},keyup_({e:t,i:e}){const i=this;i.$refs["input"+e]&&i.$nextTick(()=>{t.target.blur();var a="input"+(e+1);void 0!==i.$refs[a]?i.$refs[a][0].focus():i.$refs.addSubmit&&i.$refs.addSubmit.$el.focus()})},keyup_edit({e:t,i:e}){const i=this;i.$refs["m_input"+e]&&i.$nextTick(()=>{t.target.blur();var a="m_input"+(e+1);void 0!==i.$refs[a]?i.$refs[a][0].focus():i.$refs.editSubmit&&i.$refs.editSubmit.$el.focus()})},handleRadioChange:function(t,e,i){},handleChange:function(t,e,i){t?this.checkedData[i].push(e):this.delete(e,i)},delete(t,e){var i=this.checkedData[e].findIndex(e=>{if(e===t)return!0});this.checkedData[e].splice(i,1)},SetFirstAddFocus(){this.$nextTick(t=>{this.$refs.input0[0].focus()})},SetFirstEditFocus(){this.$nextTick(t=>{this.$refs.m_input0[0].focus()})},async openaddGroupDialog(){this.addForm.vName="",this.addForm.vRemark="",this.addForm.vIsActive=!1,this.addForm.vIsDynamic=!1,this.addDialogVisible=!0},async addGroup(){var t=(await this.$http.post("addGroup",{hGroupID:this.currentGroupID,hName:this.addForm.vName,hRemark:this.addForm.vRemark,hIsActive:this.mapBool(this.addForm.vIsActive),hIsDynamic:this.mapBool(this.addForm.vIsDynamic)}))["data"];200!==t.status?this.$message.error("新增组织失败！-- 020"+t.Msg):(this.$message.success("新增组织成功！"),this.addDialogVisible=!1,this.refreshNodeBy(this.currentGroupID))},async editGroup(){var t=(await this.$http.post("editGroup",{hParentID:this.currentGroupID,hGroupID:this.editForm.vID,hNo:this.editForm.vNo,hName:this.editForm.vName,hRemark:this.editForm.vRemark,hIsActive:this.mapBool(this.editForm.vIsActive)}))["data"];200!==t.status?this.$message.error("修改子类失败！-- 020"):(this.$message.success("修改子类成功！"),this.editDialogVisible=!1,this.refreshNodeBy(this.currentGroupID))},async deleteGroupByID(t){return 1===t.t_IsActive||0<t.CHILD_GROUPS||0<t.CHILD_USER?this.$message.error("组织处于使用状态、有子组织或者有用户,不能删除！"):"confirm"!==await this.$confirm("此操作将删除一个组织,请谨慎使用！ 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(t=>t)?this.$message.info("已取消删除!"):(t=(await this.$http.post("DeleteGroup",{hGroupID:t.t_ID}))["data"],200!==t.status?this.$message.error("删除自定义类失败！-- 030"+t.Msg):(this.$message.success("删除组织成功！"),void this.refreshNodeBy(this.currentGroupID)))},mapStatus(t){return 1===t},mapBool(t){return!0===t?1:0},async showEditDialog(t){this.editForm.vID=t.t_ID,this.editForm.vNo=t.t_No,this.editForm.vName=t.t_Name,this.editForm.vRemark=t.t_Remark,this.editForm.vIsActive=this.mapStatus(t.t_IsActive),this.editDialogVisible=!0},async getGroupList(t,e){if(t=(await this.$http.post("getGroupList",{hGroupID:t})).data,200!==t.status)return this.$message.error("获取子组织节点失败！");var i=JSON.parse(t.data);return this.groupList=JSON.parse(t.data),this.userList=JSON.parse(t.data),i.forEach(t=>{t.id=t.t_ID,t.label=t.t_Name,t.num=t.CHILD_GROUPS,0<t.CHILD_GROUPS?t.leaf=!1:t.leaf=!0}),e(i)},async getUserList(){var t=(await this.$http.post("getGroupList",{hGroupID:this.currentGroupID}))["data"];if(200!==t.status)return this.$message.error("获取子组织节点失败！");this.userList=JSON.parse(t.mStream)},handleNodeClick(t,e,i){this.currentGroupID=t.id,this.refreshNodeBy(e.data.id),this.idArray=[e.data.id]},refreshNodeBy(t){const e=this.$refs.treeList.getNode(t);e.loaded=!1,e.expand()},loadNode(t,e){if(0===t.level)return e([{id:this.currentGroupID="DEFAULTROOT",label:"组织根节点",t_IsActive:1}]);1<=t.level&&(this.currentGroupID=t.data.id,this.getGroupList(t.data.id,e))}}};i("1eb5"),i=i("2877"),i=Object(i.a)(a,(function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"mainZone",staticClass:"datalist-container"},[i("el-row",{attrs:{gutter:10}},[i("el-col",{staticClass:"col-1",attrs:{span:4}},[i("el-card",{attrs:{"body-style":{padding:"5px"}}},[i("el-scrollbar",{style:{height:t.slbHeight+"px"}},[i("el-tree",{ref:"treeList",attrs:{"default-expanded-keys":t.idArray,"highlight-current":"",id:"el-tree",props:t.cascaderProps,load:t.loadNode,"node-key":"id",lazy:""},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node;e=e.data;return i("span",{staticClass:"slot-t-node"},[i("span",{attrs:{name:a.label}},[0<e.t_IsActive?i("i",{staticClass:"iconfont"},[t._v(" ")]):i("i",{staticClass:"iconfont"},[t._v(" ")]),t._v(t._s(a.label)+" ")])])}}])})],1)],1)],1),i("el-col",{staticClass:"col-1",attrs:{span:20}},[i("el-card",{attrs:{"body-style":{padding:"5px"}}},[i("el-row",{attrs:{gutter:10}},[i("el-col",{attrs:{span:8}},[i("el-button",{attrs:{type:"primary"},on:{click:t.openaddGroupDialog}},[t._v("增加组织")])],1)],1),i("el-table",{attrs:{data:t.groupList,height:t.tableHeight,border:"",stripe:"","highlight-current-row":"","row-style":{height:"30px"},"cell-style":{padding:"0px"}}},[i("el-table-column",{attrs:{prop:"t_No",label:"序号"}}),t._e(),i("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_Name",label:"名称"}}),i("el-table-column",{attrs:{prop:"t_Remark",label:"备注"}}),i("el-table-column",{attrs:{prop:"t_CatID",label:"类别ID"}}),i("el-table-column",{attrs:{prop:"CHILD_USER",label:"用户数"}}),i("el-table-column",{attrs:{prop:"CHILD_GROUPS",label:"子组织数量"}}),i("el-table-column",{attrs:{label:"启用"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:e.row.t_IsActive,callback:function(i){t.$set(e.row,"t_IsActive",i)},expression:"scope.row.t_IsActive"}})]}}])}),i("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改该条记录",enterable:!1,placement:"top"}},[i("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini",circle:"",plain:""},on:{click:function(i){return t.showEditDialog(e.row)}}})],1),i("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:"",plain:""},on:{click:function(i){return t.deleteGroupByID(e.row)}}})]}}])})],1)],1)],1)],1),i("el-dialog",{attrs:{title:"增加组织节点",visible:t.addDialogVisible,width:"40%"},on:{"update:visible":function(e){t.addDialogVisible=e}}},[i("el-form",{staticClass:"form-1",attrs:{"label-width":"70px","label-position":"left"},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"组织名称"}},[i("el-input",{model:{value:t.addForm.vName,callback:function(e){t.$set(t.addForm,"vName",e)},expression:"addForm.vName"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{model:{value:t.addForm.vRemark,callback:function(e){t.$set(t.addForm,"vRemark",e)},expression:"addForm.vRemark"}})],1),i("el-form-item",{attrs:{label:"设置项"}},[i("el-checkbox",{model:{value:t.addForm.vIsActive,callback:function(e){t.$set(t.addForm,"vIsActive",e)},expression:"addForm.vIsActive"}},[t._v("启用")])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{ref:"editSubmit",attrs:{type:"primary"},on:{click:t.addGroup}},[t._v("确 定")]),i("el-button",{on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")])],1)],1),i("el-dialog",{attrs:{title:"修改组织信息",visible:t.editDialogVisible,width:"40%"},on:{"update:visible":function(e){t.editDialogVisible=e}}},[i("el-form",{ref:"editFieldFormRef",staticClass:"form-1",attrs:{model:t.editForm,"label-width":"70px","label-position":"left"}},[t._e(),i("el-form-item",{attrs:{label:"序号",prop:"vNo",rules:[{required:!0,message:"请输入序号",trigger:"blur"},{type:"integer",message:"请输入数值",trigger:["blur","change"]}]}},[i("el-input",{model:{value:t.editForm.vNo,callback:function(e){t.$set(t.editForm,"vNo",e)},expression:"editForm.vNo"}})],1),i("el-form-item",{attrs:{label:"名称"}},[i("el-input",{model:{value:t.editForm.vName,callback:function(e){t.$set(t.editForm,"vName",e)},expression:"editForm.vName"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{model:{value:t.editForm.vRemark,callback:function(e){t.$set(t.editForm,"vRemark",e)},expression:"editForm.vRemark"}})],1),i("el-form-item",{attrs:{label:"设置项"}},[i("el-checkbox",{model:{value:t.editForm.vIsActive,callback:function(e){t.$set(t.editForm,"vIsActive",e)},expression:"editForm.vIsActive"}},[t._v("启用状态")])],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{ref:"editSubmit",attrs:{type:"primary"},on:{click:t.editGroup}},[t._v("确 定")]),i("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)}),[],!1,null,"de8b6b58",null);e.default=i.exports}}]);