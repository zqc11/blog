(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1e7738ac"],{"6f2a":function(t,e,a){},7236:function(t,e,a){"use strict";a.r(e);var i={data(){return{vName:"",vCode:"",vRemark:"",vTypeID:"",vID:"",vNo:"",vIsUDTable:!1,vIsInborn:!1,vIsActive:!1,vIsVersion:!1,queryInfo:{query:"",pageNum:"1",pageSize:"30",catID:"IDATA"},mtemp:[""],tableHeight:JSON.parse(window.localStorage.getItem("gHeight"))-240,slbHeight:JSON.parse(window.localStorage.getItem("gHeight"))-195,mainHeight:JSON.parse(window.localStorage.getItem("gHeight"))-185,DataName:"Item Detail",addDataForm:{},editDataForm:{},editFieldForm:{},datalist:[],templist:[],FieldDropDownArgList:[],vStrOption:"",childCatList:[],catFieldList:[],editDialogVisible:!1,addDialogVisible:!1,parentCateList:[],cascaderProps:{value:"t_ID",label:"label",children:"Children",checkStrictly:!0,expandTrigger:"hover"},selectedKeys:[],cat_pid:0,cat_level:0,config:{id:"t_ID",pid:"ParentID",children:"children"},idArray:[],pageFlag:!0}},created(){this.$root.leveOnePathName="系统管理",this.$root.leveTwoPathName="类型定义",this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-240,this.slbHeight=JSON.parse(window.localStorage.getItem("gHeight"))-195,this.mainHeight=JSON.parse(window.localStorage.getItem("gHeight"))-185,this.getParentCateList(),null!==window.localStorage.getItem("currentCatID")&&(this.queryInfo.catID=window.localStorage.getItem("currentCatID"),this.idArray=[this.queryInfo.catID]),this.$nextTick((function(){this.$refs.treeList.setCurrentKey(this.queryInfo.catID)}))},mounted(){this.tempselect=this.select2,this.getChildCatList()},methods:{selectChange(t){const e=[];for(var a of(this.select2=[],this.allrole))t===a.pro&&(this.editFieldForm.t_ControlType=a.value,e.push({label:a.label,value:a.value})),this.select2=e;this.$forceUpdate()},selectValue(t){this.$forceUpdate()},dataTypeFormatter(t,e){return t=t.t_DataType,1===t?"字符":2===t?"整数":3===t?"数值":4===t?"日期":5===t?"文本":6===t?"图片":8===t?"文件":"其他"},controlTypeFormatter(t,e){return t=t.t_ControlType,0===t?"No Define":1===t?"el-input":2===t?"el-input textarea":3===t?"el-select":4===t?"el-checkbox-group":11===t?"el-radio":30===t?"el-radio-group":12===t?"el-date-picker":14===t?"el-14":15===t?"el-15":108===t?"el-108":"其他"},focus(t){},keyup_({e:t,i:e}){const a=this;a.$refs["input"+e]&&a.$nextTick(()=>{t.target.blur();var i="input"+(e+1);void 0!==a.$refs[i]?a.$refs[i][0].focus():a.$refs.addSubmit&&a.$refs.addSubmit.$el.focus()})},keyup_edit({e:t,i:e}){const a=this;a.$refs["m_input"+e]&&a.$nextTick(()=>{t.target.blur();var i="m_input"+(e+1);void 0!==a.$refs[i]?a.$refs[i][0].focus():a.$refs.editSubmit&&a.$refs.editSubmit.$el.focus()})},handleRadioChange:function(t,e,a){},handleChange:function(t,e,a){t?this.checkedData[a].push(e):this.delete(e,a)},delete(t,e){var a=this.checkedData[e].findIndex(e=>{if(e===t)return!0});this.checkedData[e].splice(a,1)},SetFirstAddFocus(){this.$nextTick(t=>{this.$refs.input0[0].focus()})},SetFirstEditFocus(){this.$nextTick(t=>{this.$refs.m_input0[0].focus()})},async openaddCatDialog(){if("confirm"!==await this.$confirm("增加分类会改变数据库结构，应由系统管理员执行。请谨慎使用！ 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(t=>t))return this.$message.info("已取消增加分类!");this.vName="",this.vCode="",this.vRemark="",this.vIsInborn=!1,this.vIsUDTable=!1,this.vIsActive=!1,this.vIsVersion=!1,this.addDialogVisible=!0},async addChildCat(){var t=(await this.$http.post("addChildCat",{hTypeID:window.localStorage.getItem("currentTypeID"),hParentCatID:this.queryInfo.catID,hName:this.vName,hRemark:this.vRemark,hIsActive:this.mapBool(this.vIsActive),hIsInborn:this.mapBool(this.vIsInborn),hIsUDTable:this.mapBool(this.vIsUDTable),hIsVersion:this.mapBool(this.vIsVersion)}))["data"];200!==t.status?this.$message.error("新增子类失败！-- 020"):(this.$message.success("新增子类成功！"),this.addDialogVisible=!1,this.getParentCateList(),this.getChildCatList())},async editChildCat(){var t=(await this.$http.post("editChildCat",{hID:this.vID,hNo:this.vNo,hName:this.vName,hCode:this.vCode,hRemark:this.vRemark,hIsActive:this.mapBool(this.vIsActive),hIsInborn:this.mapBool(this.vIsInborn),hIsUDTable:this.mapBool(this.vIsUDTable),hIsVersion:this.mapBool(this.vIsVersion)}))["data"];200!==t.status?this.$message.error("修改子类失败！-- 020"):(this.$message.success("修改子类成功！"),this.editDialogVisible=!1,this.getParentCateList(),this.getChildCatList())},async deleteCategory(t){if("confirm"!==await this.$confirm("删除子类不可逆，而且该类相关的文档、数据等都会被删除！！！确信要删除该类节点吗?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(t=>t))return this.$message.info("已取消删除");t=(await this.$http.post("deleteCategory",{hCatID:t.t_ID})).data,200!==t.status?this.$message.error("删除类节点失败！-- 030---"+t.Msg):(this.$message.success("删除类节点成功！"),this.getParentCateList(),this.getChildCatList())},async removeDataById(t){t=(await this.$http.post("dropUserDBTable",{hID:t.t_ID})).data,200!==t.status?this.$message.error("删除自定义类失败！-- 030"):(this.$message.success("删除自定义类成功！"),this.getParentCateList(),this.getChildCatList())},mapStatus(t){return 1===t},mapBool(t){return!0===t?1:0},async showEditDialog(t){this.vID=t.t_ID,this.vNo=t.t_No,this.vName=t.t_Name,this.vCode=t.t_Code,this.vRemark=t.t_Remark,this.vTypeID=t.t_TypeID,this.vIsActive=this.mapStatus(t.t_IsActive),this.vIsVersion=this.mapStatus(t.t_IsVersion),this.vIsInborn=this.mapStatus(t.t_IsInborn),this.vIsUDTable=this.mapStatus(t.t_IsUDTable),this.editDialogVisible=!0},async getOneCatInfo(){var t=(await this.$http.post("getOneCatInfo",{hCatID:this.queryInfo.catID}))["data"];200===t.status?(this.datalist=JSON.parse(t.data),this.editDataForm=JSON.parse(t.data)):this.$message.error("显示数据失败！--getOneCatInfo ")},async getChildCatList(t){var e=(await this.$http.post("getChildCatList",{hParentCatID:this.queryInfo.catID}))["data"];if(200!==e.status)return this.childCatList=[],this.$message.error("获取子类失败！");this.childCatList=JSON.parse(e.data),0===this.childCatList.length&&this.$message.success("当前类没有子类！")},async getCatFieldList(t){var e=(await this.$http.post("getCatFieldList",{hCatID:this.queryInfo.catID}))["data"];if(200!==e.status)return this.catFieldList=[],this.$message.error(" -- getCatFieldList--失败！");this.catFieldList=JSON.parse(e.data)},async getDropDownArg(t,e){var a;t=(await this.$http.post("getDropDownArg",{hCatID:t,hFieldID:e}))["data"];if(200!==t.status)return this.FieldDropDownArgList=[],this.$message.error(" -- getCatFieldList--失败！");for(a of(this.FieldDropDownArgList=JSON.parse(t.data),this.vStrOption="",this.FieldDropDownArgList))this.vStrOption=this.vStrOption+a.t_Value+";"+a.t_DispValue+"\r\n";e=this.vStrOption.length,""!==this.vStrOption&&(this.vStrOption=this.vStrOption.substring(0,e-2))},transArrToString(t){if(!Array.isArray(t))return!1;for(var e="",a=0,i=t.length;a<i;a++)0===a?e=t[a]:e+=","+t[a];return e},transStrToArr(t){return t.split(",")},async getParentCateList(){var t=(await this.$http.post("getCatTree"))["data"];if(200!==t.status)return this.$message.error("获取父级分类数据失败！");this.parentCateList=t.data1},parentCateChanged(){0<this.selectedKeys.length?(this.cat_pid=this.selectedKeys[this.selectedKeys.length-1],this.cat_level=this.selectedKeys.length):(this.cat_pid=0,this.cat_level=0)},handleNodeClick(t){this.$message.error("点击分类树的节点typeID为： "+t.TypeID),this.queryInfo.catID=t.t_ID,this.idArray=[t.t_ID],window.localStorage.setItem("currentCatID",t.t_ID),window.localStorage.setItem("currentCatName",t.label),window.localStorage.setItem("currentTypeID",t.TypeID),this.getOneCatInfo(),this.getChildCatList()}},computed:{menuLabel(){return null==this.nodeData.children?"表":"数据库"}}};a("9876"),a=a("2877"),a=Object(a.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"mainZone",staticClass:"datalist-container",style:{height:t.mainHeight+"px"}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:4}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("el-scrollbar",{style:{height:t.slbHeight+"px"}},[a("el-tree",{ref:"treeList",attrs:{"default-expanded-keys":t.idArray,"current-node-key":this.queryInfo.catID,"highlight-current":"",id:"el-tree",data:t.parentCateList,props:t.cascaderProps,"node-key":"t_ID"},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node;e=e.data;return a("span",{staticClass:"slot-t-node"},[a("span",{attrs:{name:i.label}},["IDATA"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IDOC"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IPART"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IBOMVIEW"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IFLOW"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"ISTEP"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IGROUPS"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IUSER"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):"IPROJECT"==e.TypeID?a("i",{staticClass:"iconfont"},[t._v(" ")]):a("i",{staticClass:"iconfont"},[t._v(" ")]),t._v(t._s(i.label)+" ")])])}}])})],1)],1)],1),a("el-col",{attrs:{span:20}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("el-row",{attrs:{gutter:10}},[a("el-button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"el-icon-circle-plus-outline",type:"primary"},on:{click:t.openaddCatDialog}},[t._v("增加子类")])],1),a("el-table",{attrs:{data:t.childCatList,height:t.tableHeight,border:"",stripe:"","highlight-current-row":"","row-style":{height:"30px"},"cell-style":{padding:"0px"}}},[a("el-table-column",{attrs:{prop:"t_No",label:"序号"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_ID",label:"ID"}}),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"t_ParentID",label:"ParentID"}}),t._e(),a("el-table-column",{attrs:{prop:"t_Name",label:"类名"}}),a("el-table-column",{attrs:{prop:"t_Code",label:"简码"}}),a("el-table-column",{attrs:{prop:"t_Remark",label:"备注"}}),a("el-table-column",{attrs:{label:"启用状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:e.row.t_IsActive,callback:function(a){t.$set(e.row,"t_IsActive",a)},expression:"scope.row.t_IsActive"}})]}}])}),a("el-table-column",{attrs:{label:"支持版本"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:""},model:{value:e.row.t_IsVersion,callback:function(a){t.$set(e.row,"t_IsVersion",a)},expression:"scope.row.t_IsVersion"}})]}}])}),t._e(),"IDATA"==this.queryInfo.catID?a("el-table-column",{attrs:{label:"用户DBTable"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":-1,disabled:""},model:{value:e.row.t_IsDefTable,callback:function(a){t.$set(e.row,"t_IsDefTable",a)},expression:"scope.row.t_IsDefTable"}})]}}],null,!1,2470146069)}):t._e(),a("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"修改该条记录",enterable:!1,placement:"top"}},[a("el-button",{attrs:{type:"warning",icon:"el-icon-edit",size:"mini",circle:"",plain:""},on:{click:function(a){return t.showEditDialog(e.row)}}})],1),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini",circle:"",plain:""},on:{click:function(a){return t.deleteCategory(e.row)}}})]}}])})],1)],1)],1)],1),a("el-dialog",{attrs:{title:"增加子类",visible:t.addDialogVisible,width:"70%"},on:{"update:visible":function(e){t.addDialogVisible=e}}},[a("el-form",{staticClass:"form-1",attrs:{"label-width":"70px","label-position":"left"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"类名"}},[a("el-input",{model:{value:t.vName,callback:function(e){t.vName=e},expression:"vName"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:t.vRemark,callback:function(e){t.vRemark=e},expression:"vRemark"}})],1),a("el-form-item",{attrs:{label:"设置项"}},[a("el-checkbox",{model:{value:t.vIsActive,callback:function(e){t.vIsActive=e},expression:"vIsActive"}},[t._v("启用状态")]),t._e(),"IDATA"==this.queryInfo.catID?a("el-checkbox",{model:{value:t.vIsUDTable,callback:function(e){t.vIsUDTable=e},expression:"vIsUDTable"}},[t._v("用户定义DBTable")]):t._e(),a("el-checkbox",{model:{value:t.vIsVersion,callback:function(e){t.vIsVersion=e},expression:"vIsVersion"}},[t._v("支持版本")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{ref:"editSubmit",attrs:{type:"primary"},on:{click:t.addChildCat}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"修改分类信息",visible:t.editDialogVisible,width:"70%"},on:{"update:visible":function(e){t.editDialogVisible=e}}},[a("el-form",{ref:"editFieldFormRef",staticClass:"form-1",attrs:{"label-width":"70px","label-position":"left"}},[t._e(),a("el-form-item",{attrs:{label:"序号"}},[a("el-input",{model:{value:t.vNo,callback:function(e){t.vNo=e},expression:"vNo"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-input",{attrs:{disabled:!0,readonly:!0},model:{value:t.vTypeID,callback:function(e){t.vTypeID=e},expression:"vTypeID"}})],1),a("el-form-item",{attrs:{label:"类码"}},[a("el-input",{attrs:{readonly:!0},model:{value:t.vCode,callback:function(e){t.vCode=e},expression:"vCode"}})],1),a("el-form-item",{attrs:{label:"类名"}},[a("el-input",{model:{value:t.vName,callback:function(e){t.vName=e},expression:"vName"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:t.vRemark,callback:function(e){t.vRemark=e},expression:"vRemark"}})],1),a("el-form-item",{attrs:{label:"设置项"}},[a("el-checkbox",{model:{value:t.vIsActive,callback:function(e){t.vIsActive=e},expression:"vIsActive"}},[t._v("启用状态")])],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{ref:"editSubmit",attrs:{type:"primary"},on:{click:t.editChildCat}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.editDialogVisible=!1}}},[t._v("取 消")])],1)],1)],1)}),[],!1,null,"3081b358",null);e.default=a.exports},9876:function(t,e,a){"use strict";a("6f2a")}}]);