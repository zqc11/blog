(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-0c70d399"],{"017c":function(t,e,a){"use strict";a.r(e);var i={data(){return{queryInfo:{query:"",pageNum:"1",pageSize:"30",folderID:"0"},catType:"",dirType:0,isCatDir:0,mRootID:"",mCatID:"",mSqlPath:"",tableHeight:this.$root.gScreenHeight-182,mainHeight:this.$root.gScreenHeight-70,slbHeight:this.$root.gScreenHeight-90,folderList:[],itemList:[],treeProps:{value:"t_ID",label:"label",t_Type:-1,children:"Children",isLeaf:!0,checkStrictly:!0,expandTrigger:"hover"},selectedKeys:[],idArray:[],total:0,pageFlag:!0}},created(){this.$root.leveOnePathName="目录",this.$root.leveTwoPathName="文件夹",this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-285,this.slbHeight=JSON.parse(window.localStorage.getItem("gHeight"))-195,this.mainHeight=JSON.parse(window.localStorage.getItem("gHeight"))-185,this.mainWidth=this.$root.gScreenWidth-210,null!==window.localStorage.getItem("currentFolderID")&&(this.queryInfo.folderID=window.localStorage.getItem("currentFolderID"),this.idArray=[this.queryInfo.folderID])},methods:{loadNode(t,e){if(0===t.level)return e([{id:this.currentGroupID="Root_FolderID",label:"目录根节点",t_IsActive:1}]);1<=t.level&&(2===t.data.t_Type&&(t.data.SqlPath="",t.data.t_Level=0,t.data.RootID=t.data.t_ID),2===t.data.t_Type||1===t.data.t_Type?this.getMapList(t,e):(this.currentGroupID=t.data.id,this.getDirList(t.data.id,e)))},async getDirList(t,e){if(t=(await this.$http.post("getDirList",{hDirID:t,hFolderFlag:2})).data,200!==t.status)return this.$message.error("获取子组织节点失败！");var a=JSON.parse(t.data);return this.groupList=JSON.parse(t.data),a.forEach(t=>{t.id=t.t_ID,t.label=t.t_Name,t.leaf=t.Children}),e(a)},async getMapList(t,e){if(t=(await this.$http.post("getMapList",{hID:t.data.t_ID,hRootID:t.data.RootID,hSqlPath:t.data.SqlPath,hLevel:t.data.t_Level})).data,202===t.status)return e([]);if(201===t.status)return this.$message.error("获取子组织节点失败！");var a=JSON.parse(t.data);return this.groupList=JSON.parse(t.data),a.forEach(t=>{t.id=t.t_ID,t.label=t.label,t.t_Level=t.t_level,t.RootID=t.RootID,t.t_Type=1,t.isLeaf=t.leaf}),e(a)},async getFolderTree(){var t=(await this.$http.post("getFolderTree",{hFolderID:"Root_FolderID"}))["data"];if(200!==t.status)return this.$message.error("获取目录树数据失败！");this.folderList=t.data1},async getFolderItem(){var t=(await this.$http.post("getFolderItem",{query:this.queryInfo.query,pageNum:this.queryInfo.pageNum,pageSize:this.queryInfo.pageSize,hFolderID:this.queryInfo.folderID,hCatType:this.catType,hIsCatDir:this.isCatDir,hToken:window.sessionStorage.getItem("token"),hVersion:this.mVersion}))["data"];return 202===t.status?(this.itemList=[],this.$message.error("请重新登录！")):200!==t.status?(this.itemList=[],this.$message.error("显示数据失败！"+t.Msg)):(0!==t.total?(this.itemList=JSON.parse(t.data),this.editItemID=this.itemList[0].t_ID,this.ItemName=this.itemList[0].t_Name,this.ItemCode=this.itemList[0].t_Code,this.ItemCatID=this.queryInfo.folderID):this.itemList=[],this.tableBfieldlist=JSON.parse(t.tableBfield),this.total=t.total,this.pageFlag=this.total>this.queryInfo.pageSize,!0===this.pageFlag?this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-285:this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-240,void this.$nextTick(()=>{this.$refs.tableRef.setCurrentRow(this.itemList[0])}))},async getMapItem(){var t=(await this.$http.post("getMapItem",{query:this.queryInfo.query,pageNum:this.queryInfo.pageNum,pageSize:this.queryInfo.pageSize,hDirID:this.queryInfo.folderID,hRootID:this.mRootID,hCatType:this.mCatID,hSqlPath:this.mSqlPath,hToken:window.sessionStorage.getItem("token"),hVersion:this.mVersion}))["data"];return 202===t.status?(this.itemList=[],this.$message.error("请重新登录！")):200!==t.status?(this.itemList=[],this.$message.error("显示数据失败！"+t.Msg)):(0!==t.total?(this.itemList=JSON.parse(t.data),this.editItemID=this.itemList[0].t_ID,this.ItemName=this.itemList[0].t_Name,this.ItemCode=this.itemList[0].t_Code,this.ItemCatID=this.queryInfo.folderID):this.itemList=[],this.tableBfieldlist=JSON.parse(t.tableBfield),this.total=t.total,this.pageFlag=this.total>this.queryInfo.pageSize,!0===this.pageFlag?this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-285:this.tableHeight=JSON.parse(window.localStorage.getItem("gHeight"))-240,void this.$nextTick(()=>{this.$refs.tableRef.setCurrentRow(this.itemList[0])}))},handleSizeChange(t){this.queryInfo.pageSize=t,this.getFolderItem()},handleCurrentChange(t){this.queryInfo.pageNum=t,this.getFolderItem()},handItemRowClick(t,e,a){},handleNodeClick(t){this.queryInfo.folderID=t.t_ID,this.idArray=[t.t_ID],this.catType=t.CObjDataType,this.isCatDir=t.t_IsCat,this.mRootID=t.RootID,this.mCatID=t.TypeID,this.mSqlPath=t.SqlPath,this.dirType=t.t_Type,window.localStorage.setItem("currentFolderID",t.t_ID),0===t.t_Type&&this.getFolderItem(),1===t.t_Type&&this.getMapItem()}}};a("6551"),a=a("2877"),a=Object(a.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"mainZone",staticClass:"datalist-container",style:{height:t.mainHeight+"px"}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:4}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("el-scrollbar",{style:{height:t.slbHeight+"px"}},[a("el-tree",{ref:"treeList",attrs:{"default-expanded-keys":t.idArray,"current-node-key":this.queryInfo.folderID,"highlight-current":"",props:t.treeProps,load:t.loadNode,lazy:"","node-key":"id"},on:{"node-click":t.handleNodeClick}})],1)],1)],1),a("el-col",{attrs:{span:20}},[a("el-card",{attrs:{"body-style":{padding:"5px"}}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{placeholder:"请输入文件名",clearable:""},on:{clear:t.getFolderItem},model:{value:t.queryInfo.query,callback:function(e){t.$set(t.queryInfo,"query",e)},expression:"queryInfo.query"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.getFolderItem},slot:"append"})],1)],1)],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:0<t.itemList.length,expression:"itemList.length > 0 ? true: false"}],ref:"tableRef",attrs:{data:t.itemList,height:t.tableHeight,border:"","highlight-current-row":"","row-style":{height:"30px"},"cell-style":{padding:"0px"}},on:{"row-click":t.handItemRowClick}},[a("el-table-column",{attrs:{type:"index"}}),a("el-table-column",{attrs:{prop:"t_Name",label:"名称","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"t_Code",label:"代号",width:"120px","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"v_CatName",label:"类别",width:"120px","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{prop:"v_CreateByName",label:"创建人",width:"100px"}}),a("el-table-column",{attrs:{prop:"v_ModByName",label:"修改人",width:"100px"}}),a("el-table-column",{attrs:{prop:"t_LastModTime",label:"修改时间",width:"120px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.t_LastModTime.substring(2,16).replace("T"," ")))])]}}])}),a("el-table-column",{attrs:{prop:"t_CreateTime",label:"创建时间",width:"75px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.t_LastModTime.substring(0,7)))])]}}])}),a("el-table-column",{attrs:{prop:"t_Ver",label:"版本",width:"50px"}})],1),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.pageFlag,expression:"pageFlag"}],attrs:{"current-page":t.queryInfo.pagenum,"page-sizes":[30,50,100,200],"page-size":t.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)],1)}),[],!1,null,"4dbafc80",null);e.default=a.exports},"62fb":function(t,e,a){},6551:function(t,e,a){"use strict";a("62fb")}}]);